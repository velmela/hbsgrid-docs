---
tags:
  - CSV
  - Unix
  - MariaDB
---

# Importing a CSV into MariaDB {#csv-mariadb}

This tutorial provides an example of how to import a large CSV into the MariaDB database on the HBSGrid.

## Preparing your CSV File {#prepare-csv}

In our example, we have a 7GB CSV file that we'd like to import into MariaDB. To manage its size, prior to import we'd like to only select the specific columns that we will need downstream. 

First, using the terminal in NoMachine or your computer, take a quick look at the file to see what columns are in the data.

``` sh
head name_of_your_csv.csv
```
By default, the head command will show you the first 10 lines of a csv, including the header:

``` sh
CompanyID,CompanyName,subcategory1,subcategory2,subcategory3
100003-15,Company1,1,1,1
100003-15,Company2,2,5,7
100003-15,Company3,4,8,0
100003-15,Company4,2,6,3
100003-15,Company5,7,3,9
100003-15,Company6,6,1,9
100003-15,Company7,6,9,8
100003-15,Company8,1,7,6
100003-15,Company9,2,4,5
```
After looking at the data, you decide you only want to keep the CompanyID, CompanyName, and subcategory1. You can do this efficiently using Unix commands in the terminal, selecting the specific columns you'd like to keep using column numbers. It takes minimal time and RAM and reduces your file to about 40GB.

``` sh
cut -d ',' -f 1-3 name_of_your_csv.csv > name_of_your_csv_small.csv
```

## Importing your CSV File into MariaDB {#import-csv}

Create an empty table in your database. You can do this using DBeaver on the HBSGrid or continue in your terminal using the following commands (note that the host name can also be found in the configuration file you received when your database account was created):

``` sh
mysql -h [HBShostname] -u jharvard -p yourmariadbpassword
```
``` sh
MariaDB [jharvard_name_of_db] > CREATE TABLE new_table (
  ->CompanyID VARCHAR(20),
  -> CompanyName TEXT,
  -> subcat1 TEXT
  -> );
```
You can check that the empty table has been created as expected using the following commands:

``` sh
MariaDB [jharvard_name_of_db] > describe new_table
```

Now you can load the csv file into MariaDB:

``` sh
MariaDB [jharvard_name_of_db] > LOAD DATA LOCAL INFILE '/export/mdb_external/import/jharvard/name_of_your_csv_small.csv' INTO TABLE jharvard_name_of_db.new_table FIELDS TERMINATED BY ',' LINES TERMINATED BY '\n' IGNORE 1 LINES; 
```
You can run a few descriptives to ensure that the import was successful and to get to know your data. For example, checked how many unique firms you have

``` sh
MariaDB [jharvard_name_of_db]> SELECT COUNT(DISTINCT CompanyID) AS num_firms FROM new_table; 
```

You can also check the minimum and maximum ID numbers:

``` sh
MariaDB [jharvard_name_of_db]> SELECT MIN(CompanyID) AS min_CompanyID, MAX(CompanyID) AS max_CompanyID FROM new_table; 
```
**Important**

Databases must be indexed for efficient and fast retrieval and processing downstream. In our example case, if we anticipate querying or merging the data by CompanyID, the database should be indexed on this variable:

``` sh
MariaDB [jharvard_name_of_db]> CREATE INDEX idx_new_table ON new_table (CompanyID);
```
Your table is ready for use! 
